# Default values for baby-names.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

nameOverride: ""
fullnameOverride: ""

# Namespace configuration
# NOTE: Namespace is created by Terraform, not Helm
namespace:
  name: baby-names  # Must match Terraform-created namespace

# Service account configuration
# NOTE: ServiceAccount is created by Terraform with Workload Identity binding
serviceAccount:
  name: baby-names-app  # Must match Terraform-created service account

# Backend configuration
backend:
  replicaCount: 2
  image:
    repository: europe-west1-docker.pkg.dev/extended-ascent-477308-m8/idp-pov/baby-names-backend
    pullPolicy: IfNotPresent
    tag: "" # Defaults to chart appVersion if not set
  service:
    type: ClusterIP
    port: 5000
  resources:
    requests:
      memory: "256Mi"
      cpu: "200m"
    limits:
      memory: "512Mi"
      cpu: "500m"
  env:
    DB_HOST: localhost
    DB_PORT: "5432"
    DB_NAME: baby_names
    DB_USER: "" # Set in environment-specific values
    DB_PASSWORD: "" # Set in environment-specific values (not used with IAM auth)
    DB_IAM_AUTH: "false"
  securityContext:
    runAsNonRoot: true
    runAsUser: 1000
    allowPrivilegeEscalation: false
    capabilities:
      drop:
        - ALL
  podAnnotations: {}

# Frontend configuration
frontend:
  replicaCount: 2
  image:
    repository: europe-west1-docker.pkg.dev/extended-ascent-477308-m8/idp-pov/baby-names-frontend
    pullPolicy: IfNotPresent
    tag: "" # Defaults to chart appVersion if not set
  service:
    type: ClusterIP
    port: 8080
  resources:
    requests:
      memory: "256Mi"
      cpu: "200m"
    limits:
      memory: "512Mi"
      cpu: "500m"
  env:
    BACKEND_URL: http://backend:5000
  securityContext:
    runAsNonRoot: true
    runAsUser: 1000
    allowPrivilegeEscalation: false
    capabilities:
      drop:
        - ALL
  podAnnotations: {}

# Database migration job
migration:
  image:
    repository: europe-west1-docker.pkg.dev/extended-ascent-477308-m8/idp-pov/baby-names-db-migration
    pullPolicy: IfNotPresent
    tag: "" # Defaults to chart appVersion if not set
  resources:
    requests:
      memory: "256Mi"
      cpu: "200m"
    limits:
      memory: "512Mi"
      cpu: "500m"
  env:
    DB_HOST: localhost
    DB_PORT: "5432"
    DB_NAME: baby_names
    DB_USER: "" # Set in environment-specific values
    DB_PASSWORD: "" # Set in environment-specific values (not used with IAM auth)
    DB_IAM_AUTH: "false"
  securityContext:
    runAsNonRoot: true
    runAsUser: 1000
    allowPrivilegeEscalation: false
    capabilities:
      drop:
        - ALL
  backoffLimit: 3

# Database configuration
database:
  instanceConnectionName: "" # Format: project:region:instance
  iamAuth: false

# Ingress configuration
ingress:
  enabled: true
  className: "gce"
  annotations:
    kubernetes.io/ingress.class: "gce"
    kubernetes.io/ingress.global-static-ip-name: ""
  hosts:
    - host: ""
      paths:
        - path: /
          pathType: Prefix
          backend: frontend
        - path: /api
          pathType: Prefix
          backend: backend
  tls: []
    # - secretName: baby-names-tls
    #   hosts:
    #     - baby-names.example.com
